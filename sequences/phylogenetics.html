<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Phylogenetics</title>

		<meta name="author" content="Trevor Bedford">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../reveal/css/reveal.min.css">
		<link rel="stylesheet" href="../reveal/css/theme/trvrb.css" id="theme">
		<link rel="stylesheet" href="../reveal/css/font-awesome/css/font-awesome.min.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../reveal/lib/css/zenburn.css">

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div style="position: absolute; top:10px; left:10px; z-index:100;">
			<a href="http://bedford.io/projects/sismid/sequences/">
				<i class="fa fa-times-circle" style="color: #bbb; opacity: 0.1;"></i>
			</a>
		</div>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section data-background="#ACD1A0">
					<h2 class="title">Phylogenetics</h2>
				</section>

				<section data-background="#000000">
					<img class="stretch" src="images/darwin_phylogeny.jpg">
				</section>

				<section data-background="#000000">
					<img class="stretch" src="images/darwin_phylogeny_tattoo.jpg">
				</section>

				<section data-transition="none">
					<h3>Phylogeny describes evolutionary relationships</h3>
					<img class="stretch" src="images/parsimony_1.png">
				</section>

				<section data-transition="none">
					<h3>Phylogeny is usually a hypothesis based on characteristics of sampled taxa</h3>
					<img class="stretch" src="images/parsimony_2.png">
				</section>

				<section data-transition="none">
					<h3>Phylogeny implies a series of mutational events leading to observed tip states</h3>
					<img class="stretch" src="images/parsimony_3.png">
				</section>

				<section>
					<h3>
					<a href="https://en.wikipedia.org/wiki/Maximum_parsimony_(phylogenetics)">Parsimony</a> is
					based on <a href="https://en.wikipedia.org/wiki/Occam's_razor">Occam's razor</a></h3>
					<p>
					Among competing
					hypotheses that predict equally well, the one with the fewest assumptions should be selected.</p>
				</section>

				<section>
					<h3>Parsimony suggests this topology requires 3 mutations at minimum</h3>
					<img class="stretch" src="images/parsimony_4.png">
				</section>

				<section>
					<h3>Parsimony suggests both topologies equally tenable</h3>
					<img class="stretch" src="images/parsimony_5.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_1.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_2.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_3.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_4.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_5.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_6.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_7.png">
				</section>

				<section data-transition="none">
					<h3><i>Exercise: which topology is more likely under parsimony?</i></h3>
					<img class="stretch" src="images/parsimony_exercise_8.png">
				</section>

				<section>
					<h3><a href="http://vincebuffalo.org/dancinggenealogies2/">Example of how phylogeny structures site patterns</a></h3>
					<div class="citation">
						<a href="https://github.com/vsbuffalo/coaljs">
							Buffalo. 2015
						</a>
					</div>
				</section>

				<section data-background="#B9D395">
					<h2 class="title">Inferring phylogenies with likelihood</h2>
				</section>

				<section>
					<h3>Data likelihood</h3>
					<br>
					<p>
					In phylogenetics, $D$ are the observed tip sequences and $\theta$ is the phylogenetic tree
					including topology and branch lengths, so that the data likelihood follows $\mathrm{Pr}(D \, | \, \theta)$.
					</p>
				</section>

				<section>
					<h3>Calculating the likelihood of a single topology</h3>
					<img class="stretch" src="images/likelihood_tree_1.png">
				</section>

				<section>
					<h3>Transition probability for each branch</h3>
					<img class="stretch" src="images/likelihood_tree_2.png">
				</section>

				<section>
					<h3>Rather than enumerating all possible internal states</h3>
					<img class="stretch" src="images/likelihood_tree_3.png">
				</section>

				<section>
					<h3>Can use Felstenstein's pruning algorithm to speed up calculation</h3>
					<img class="stretch" src="images/likelihood_tree_4.png">
					<div class="citation">
						<a href="http://link.springer.com/article/10.1007/BF01734359">
							Felsenstein 1981
						</a>
					</div>
				</section>

				<section>
					<h3>ML inference</h3>
					<br>
					<p>
					Inference becomes a search for the tree that maximizes the likelihood of observing tip sequences $\mathrm{Pr}(D \, | \, \theta)$.
					Lots of computation goes into this.
					</p>
				</section>

				<section data-background="#C6D38C">
					<h2 class="title">Bayesian phylogenetic inference</h2>
				</section>

				<section>
					<h3>Bayesian phylogenetic inference</h3>
					<br>
					<p>
					Here, we are interested in the posterior distribution $\mathrm{Pr}(\tau, \mu \, | \, D)$, where $D$
					represents sequence data, $\tau$ represents the tree topology and $\mu$ represents mutational parameters
					(like transition vs tranversion rate). In this case,
					$$ \mathrm{Pr}(\tau, \mu \, | \, D) \propto \mathrm{Pr}(D \, | \, \tau, \mu) \, \mathrm{Pr}(\tau) \, \mathrm{Pr}(\mu). $$
					</p>
				</section>

				<section>
					<h3>Bayesian coalescent inference</h3>
					<br>
					<p>
					In the case of the coalescent model, we are interested in coalescent rate parameter like $\lambda$. Here,
					we use $\lambda$ to give the likelihood of observing a particular tree topology $\mathrm{Pr}(\tau \, | \, \lambda)$.
					This probability is the likelihood of observing the coalescent intervals seen in the tree.
					</p>
				</section>

				<section>
					<h3>Bayesian coalescent inference</h3>
					<br>
					<p>
					Thus, the full model becomes
					$$ \mathrm{Pr}(\tau, \mu, \lambda \, | \, D) \propto
						\mathrm{Pr}(D \, | \, \tau, \mu) \, \mathrm{Pr}(\tau \, | \, \lambda) \, \mathrm{Pr}(\lambda) \, \mathrm{Pr}(\mu). $$
					Bayesian approaches work well to build these sorts of nested models.
					</p>
				</section>

				<section data-transition="none">
					<h3>Markov chain Monte Carlo (MCMC)</h3>
					<img class="stretch" src="images/mcmc_2.png">
				</section>

				<section>
					<h2><a href="http://beast.bio.ed.ac.uk/">
						BEAST: Bayesian Evolutionary Analysis by Sampling Trees
					</a></h2>
				</section>

			</div>

		</div>

		<script src="../reveal/lib/js/head.min.js"></script>
		<script src="../reveal/js/reveal.min.js"></script>
		<script src="../reveal/js/config.js"></script>

	</body>
</html>
